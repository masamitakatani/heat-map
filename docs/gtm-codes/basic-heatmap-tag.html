<!-- GTM ã‚«ã‚¹ã‚¿ãƒ HTMLã‚¿ã‚° - ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆåŸºæœ¬ç‰ˆï¼‰ -->
<!-- ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’Googleã‚¿ã‚°ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã®ã€Œã‚«ã‚¹ã‚¿ãƒ HTMLã€ã‚¿ã‚°ã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ -->

<script>
(function() {
  'use strict';

  // æ—¢ã«èª­ã¿è¾¼ã¿æ¸ˆã¿ã®å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—
  if (window.HeatmapAnalytics) {
    console.log('âš ï¸ ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯æ—¢ã«èª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã™');
    return;
  }

  // ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å‹•çš„ã«èª­ã¿è¾¼ã‚€
  var script = document.createElement('script');
  script.src = 'https://heat-cvnvx2ln9-masamitakatani-4585s-projects.vercel.app/heatmap-analytics.umd.js';
  script.async = true;

  script.onload = function() {
    console.log('âœ… ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ãƒ©ã‚¤ãƒ–ãƒ©ãƒªèª­ã¿è¾¼ã¿å®Œäº†');

    // åˆæœŸåŒ–
    try {
      var tracker = new window.HeatmapAnalytics({
        api: {
          apiKey: 'gtm-integration',
          projectId: window.location.hostname.replace(/\./g, '-'),
          baseUrl: 'https://api.connected-one.com/v1'
        },
        debug: true,
        autoStart: true,
      });

      tracker.init();
      window.heatmapTracker = tracker;

      console.log('âœ… ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—åˆæœŸåŒ–å®Œäº†');
      console.log('ğŸ“Š Session ID:', tracker.getSessionId());
      console.log('ğŸ‘¤ Anonymous ID:', tracker.getAnonymousId());

    } catch (error) {
      console.error('âŒ ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:', error);
    }
  };

  script.onerror = function() {
    console.error('âŒ ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ');
  };

  document.head.appendChild(script);
})();
</script>
